"use strict";angular.module("myApp",["ngRoute","ngAnimate","myApp.editor"]).config(["$routeProvider",function(e){e.otherwise({redirectTo:"/index"})}]),function(){function e(){var e=this;return e.editor="",e.result="",e}function t(e,t,o){var n=this;n.$storage=e,n.editStatus=!1,n.categorySelected=1,n.noteSelected=1,n.openModal=!1,n.category={},n.note={},n.categoryList=[],n.noteList=[],n.note={};var i={init:function(){this.initCategory(),this.initNote(n.categorySelected)},initCategory:function(){n.categoryList=t.getCategoryList()},initNote:function(e){n.noteList=t.getNoteListById(e),0!=n.noteList.length&&(n.note=n.noteList[0],n.noteSelected=n.note.id)},resetNote:function(){n.note={}}};i.init(),n.edit=function(){n.editStatus=!0},n.save=function(){n.editStatus=!1,n.note.updateTime=o("date")(new Date,"yyyy-MM-dd HH:mm:ss"),t.updateNote(n.categorySelected,n.note)},n.selectCategory=function(e){n.categorySelected=e,i.initNote(e)},n.selectNote=function(e){n.noteSelected=e.id,n.note=e},n.open=function(e){n.type=e,n.openModal=!0},n.add=function(e){if("category"==e){var r={id:t.generateId(n.categoryList),name:n.name,noteList:[]};t.saveCategory(r),n.name="",n.openModal=!1,n.categorySelected=r.id,i.initNote(n.categorySelected)}else if("note"==e){var a={id:t.generateId(t.getNoteListById(n.categorySelected)),title:n.name,createTime:o("date")(new Date,"yyyy-MM-dd HH:mm:ss"),updateTime:o("date")(new Date,"yyyy-MM-dd HH:mm:ss")};n.note=t.saveNote(n.categorySelected,a),n.name="",n.openModal=!1,n.noteSelected=a.id,n.noteList=t.getNoteListById(n.categorySelected)}},n.cancel=function(){n.openModal=!1},n.delCategory=function(e){t.deleteCategory(e),event.preventDefault()},n.delNote=function(e){t.deleteNote(n.categorySelected,e),i.resetNote(),event.preventDefault()}}t.$inject=["$localStorage","NoteService","$filter"],angular.module("myApp.editor",["ngRoute","hljs","editor.filter","ngStorage","editor.service"]).config(["$routeProvider",function(e){e.when("/editor",{templateUrl:"views/editor.html",controller:"EditorController"}).when("/index",{templateUrl:"views/index.html",controller:"IndexController"})}]).controller("EditorController",e).controller("IndexController",t)}(),function(){"uss strict";angular.module("editor.filter",[]).filter("render",["$sce",function(e){return function(t){return angular.isUndefined(t)||0!=t.length&&(t=marked(t)),e.trustAsHtml(t)}}])}(),function(){function e(e){function t(e,t){var o=-1;return e.forEach(function(e,n){e.id==t&&(o=n)}),o}function o(e){return console.log(e),0==e.length?1:e[e.length-1].id+1}function n(){return e.categoryList||(e.categoryList=[]),e.categoryList}function i(o){var i=t(n(),o);return e.categoryList[i].noteList}function r(e,t){var o=_getNoteListById(e).filter(function(e){return e.id==t});return 0==o.length?null:o[0]}function a(t){e.categoryList.push(t)}function c(t){t.id&&(e.categoryList[t.id-1]=t)}function d(o,i){var r=t(n(),o);return-1!=r&&e.categoryList[r].noteList.push(i),i}function l(o,i){var r=t(n(),o),a=_getNoteListById(o);if(i.id){var c=t(a,i.id);a[c]=i,e.categoryList[r].noteList=a}}function u(o){var i=t(n(),o);e.categoryList.splice(i,1)}function s(o,r){var a=t(n(),o),c=t(i(o),r);e.categoryList[a].noteList.splice(c,1)}return{generateId:o,getCategoryList:n,getNoteListById:i,getNoteById:r,saveCategory:a,updateCategory:c,saveNote:d,updateNote:l,deleteCategory:u,deleteNote:s}}e.$inject=["$localStorage"],angular.module("editor.service",[]).factory("NoteService",e)}();